## 《废土弹雨》开发路线图

> 目标：在 Godot 4.5 上完成 2D 俯视 looter-shooter 的最小可玩原型，并为后续迭代（区推进、精英/Boss、build 爽点）打好基础。

---

### 阶段 0：环境与基础设施

1. **工程骨架**
   - 建立 Godot 4.5 项目目录，规划 `scenes/`, `scripts/`, `data/`, `ui/`, `assets/` 等子目录。
   - 配置输入映射（移动、瞄准、射击、换枪、交互、暂停），提前做好键鼠与手柄共存。
2. **调试工具**
   - 建基本调试 HUD（FPS、玩家状态、当前武器属性）。
   - 写简单的调试脚本支持热加载 JSON 数据、重置关卡。
3. **数据驱动管线**
   - 设计 `data/weapons.json`, `data/enemies.json`, `data/drop_tables.json` 等结构，建立读取器（`autoload` 单例）。
   - 约定所有可调数值（武器面板、敌人血量、drop rate）必须来自 JSON，便于以后用表格迭代。

---

### 阶段 1：玩家核心闭环

1. **移动与瞄准**
   - Top-down 8 向移动，加入加速度/阻尼参数，调出最基础的手感。
   - 鼠标/摇杆双方案瞄准，朝向 -> 武器指向，准星根据输入设备切换。
2. **射击与受击**
   - 实现第一把基础枪（例如半自动手枪），决定使用射线还是物理弹丸；完成发射、碰撞、命中反馈。
   - 玩家血量/护盾系统，受击硬直或屏幕反馈，保持可拓展。
3. **武器模块化**
   - 构建 WeaponBase.gd：支持开火速率、弹夹、后坐力、散布、词条Hook。
   - 建 `PlayerGunController` 管理装备/开火/CD。

里程碑：玩家能在空地图中移动、瞄准并击中测试靶。

---

### 阶段 2：敌人 AI 与刷怪波次

1. **基础敌人**
   - 先实现一类杂兵：巡逻 → 发现玩家 → 追击 → 攻击（近战/远程任选）。
   - 简易状态机 + 寻路（`NavigationAgent2D`），可配置速度与攻击方式。
2. **波次系统**
   - `WaveSpawner` 读取 `data/waves.json`，按区间刷怪：数量、种类、出生点、间隔。
   - 设计可扩展接口，支持后续按区域难度提升。
3. **反馈与清算**
   - 敌人受击/死亡动画、掉血数字占位、死亡信号用于驱动掉落/统计。

里程碑：一波敌人能被玩家击败，流程无崩溃。

---

### 阶段 3：武器、掉落与随机性

1. **武器数据系统**
   - `data/weapons.json` 描述基础属性；`data/affixes.json` 定义词条池、稀有度、多条叠加规则。
   - `WeaponFactory` 根据掉落稀有度/关卡级别生成最终武器，附上词条、前缀名称、颜色。
2. **掉落流程**
   - 敌人死亡触发 `LootDropper`：读取 `drop_tables.json` 计算掉落概率，生成拾取物实体（显示品质光柱）。
   - 拾取交互（按键/接触弹窗），展示新武器属性，与当前武器对比关键数值。
3. **三把基础枪**
   - 设计三种手感：连射 SMG、高伤单发猎枪、持续束激光等；在 JSON 中配置，用于验证系统灵活度。

里程碑：击杀敌人会随机掉落武器，玩家可以拾取并更换，UI 有清晰反馈。

---

### 阶段 4：UI / UX 框架

1. **HUD**
   - 血量、护盾、武器信息（名字、弹药、稀有度色条）、掉落提示。
   - 伤害飘字、命中提示（十字准星变化）。
2. **菜单与交互**
   - 暂停菜单（设置、退出、重开），键鼠/手柄统一导航。
   - 换枪面板：对比两把武器属性（高亮提升/下降），确认/放弃逻辑。
3. **提示系统**
   - 新掉落提示、波次开始/完成提示、区段难度提示。

里程碑：完整 HUD 和交互界面可操作，不影响战斗节奏。

---

### 阶段 5：生死循环与区推进

1. **区域与难度递增**
   - 定义关卡/区域参数：怪物血量/伤害倍率、掉落稀有度加成、特殊事件。
   - 完成关卡入口/出口交互，推进到下一片区域。
2. **Run 状态管理**
   - `RunManager` 记录当前 build、区域进度、统计信息（击杀数、掉落数、最佳武器）。
   - 死亡时弹出结算 UI，可查看统计并选择“重开/退出”。
3. **重开与保存**
   - 简单的 meta progression 占位（例如记录最高区域），为后续持久奖励预留接口。

里程碑：玩家能经历“进入关卡 → 战斗 → 掉落 → 换枪 → 下一区 → 死亡/结算 → 重开”的完整循环。

---

### 阶段 6：打磨与扩展

1. **数值平衡与手感**
   - 对武器后坐力、散布、敌人攻击频率等进行数轮调参，记录表格。
   - 引入音效、屏幕震动、命中特效，提升爽感。
2. **精英/Boss 竖切片**
   - 设计一名精英和一个 mini-boss，强调新机制（护盾、弱点、范围技），测试 build 多样性。
3. **潜行爆发 build 雏形**
   - 引入词条/被动支持“潜行-爆发”玩法：如隐身、首击全暴击、短 CD 爆发技能。
4. **技术债 & 优化**
   - 清理临时代码、补测试场景、分析性能热点，准备后续内容扩展。

里程碑：首个“爽点 build” Demo，可对外展示核心乐趣。

---

## 工具与实践建议

- **项目结构**：遵循模块化，玩家/敌人/武器/掉落/波次/UI 独立脚本，使用 Godot 信号解耦。
- **调试节奏**：每个阶段完成后录制短视频或写日志，便于回归；保持单人迭代节拍。
- **自动化**：考虑写 `res://tools/DataHotReload.gd` 等脚本，快捷键刷新 JSON，不必重启场景。
- **美术 placeholder**：用简单 Vector/色块先搭建，后续用 NanoBanana 批量产出。
- **风险控制**：随时注意数值写死、硬编码路径、未收敛的输入映射等问题；一旦发现立即抽象成数据。

---

## 里程碑与验收

1. **M1：玩家闭环**（阶段 1 完成）  
   - ✅ 空场景内可移动、瞄准、射击靶子。
2. **M2：第一波敌人**（阶段 2 完成）  
   - ✅ 刷怪、战斗、敌人可被击败，无致命 BUG。
3. **M3：掉落与换枪**（阶段 3 + 4 完成）  
   - ✅ 击杀掉落随机武器，UI 提示 + 对比换装。
4. **M4：完整 Run**（阶段 5 完成）  
   - ✅ 多区域循环、死亡结算、重开。
5. **M5：爽点 Demo**（阶段 6 完成）  
   - ✅ 精英/Boss 展示、潜行爆发 build 呈现。

---

保持“先好玩再好看”的原则，每次只推进一个闭环。完成以上路线后，再扩展内容、打磨美术与音效。
